<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='Styling/StylingHeaderFooter.css')}}">
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='Styling/StylingHamburgerMenu.css')}}">
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='Styling/StylingScrollbar.css')}}">
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='Styling/login.css')}}">
<link rel="shortcut icon" href="{{url_for('static', filename='Images/Icon/favicon.ico')}}">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="{{
  url_for('static', filename ='Scripts/jquery.js') }}">\x3C/script>')</script>
  
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>
<script>
    window.jQuery || document.write('<script src="{{
        url_for('static', filename ='Scripts/jquery-ui.js') }}">\x3C/script>')</script>

        <meta name="csrf-token" content="{{ csrf_token() }}">
<script>
    var csrftoken = $('meta[name=csrf-token]').attr('content');

    $.ajaxSetup({
        beforeSend: function(xhr, settings) {
            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrftoken)
            }
        }
    })
</script>

<html>
    <head>
        {% if title %}
        <title>{{ title }} - DeepSpace</title>
        {% else %}
        <title>Welcome</title>
        {% endif %}
    </head>
    <body>
        <script src="{{ url_for('static', filename='Scripts/JavascriptHamburgerMenu.js') }}"></script>
        <script src="{{ url_for('static', filename='Scripts/JavascriptSubmission.js') }}"></script>
        <ul class="navMain">
            <li>
                <div class="container" id="x" onclick="myFunction(this)">
                    <div class="bar1"></div>
                    <div class="bar2"></div>
                    <div class="bar3"></div>
                </div>
            </li>
            <li><a href="/">Home</a></li>
            <li><a href="/news">News</a></li>
            <li class="dropdown" id="dropdown">
                <a  class="dropbtn">Acknowledgement</a>
                <div class="dropdown-content Acknowledgement">
                    <a href="/team">Our Team</a>
                    <a href="/funding">Funders</a>
                </div>
            </li>
            <li class="dropdown" id="dropdown">
                <a class="dropbtn" href="/tutorial">Tutorial</a>
                <div class="dropdown-content tutorial">
                    <a href="/tutorial#drawingPart">Drawing</a>
                    <a href="/tutorial#tablePart">Table</a>
                    <a href="/tutorial#annotationPart">Annotation</a>
                </div>
            </li>
            <li><a href="/annotate" class="getInvolved">Get Involved</a></li>
            <li><a href="#" id="loginbtn">Login</a></li>
        </ul>
        <script src="{{ url_for('static', filename='Scripts/login.js') }}"></script>


        <div id="logindiv" class="modal">
            <div class="modalcontent">
                {% block login %}{% endblock %}
            </div>
        </div>
        <script>
            $(function () {
                $('a#loginbtn').bind('click', function () {
                    var csrftoken = $('meta[name=csrf-token]').attr('content')
                    var url = "{{ url_for('auth.login') }}";

                    // $.ajaxSetup({
                    //     beforeSend: function(xhr, settings) {
                    //         if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                    //             xhr.setRequestHeader("X-CSRFToken", csrftoken)
                    //         }
                    //     }
                    // });

                    $.get(url, function(data) {
                        console.log(data)
                        $('#logindiv .modalcontent').html(data);
                        $('#logindiv').css('display','block');
                        console.log("login get")

                        $('#submit').click(function(event) {
                            console.log("my code running")
                            event.preventDefault();
                            console.log("Attempting to post login data");
                            console.log($('#login_form').serialize())
                            $.ajax({
                                url: url,
                                data: $('#login_form').serialize(),
                                contentType: "application/json; charset=utf-8",
                                type: 'POST',
                                success: function (response) {
                                    response = JSON.parse(response)
                                    console.log(response);
                                },
                                error: function (error) {
                                    console.log(error);
                                    // error = JSON.parse(error);
                                    // console.log(error);
                                }
                            });

                            // $.post(url, data=$('#login_form').serialize(), function(data) {
                            //     if (data.status == 'ok') {
                            //         $('#logindiv').css('display','none');
                            //         location.reload();
                            //     } else {
                            //         // $('#logindiv .modalcontent').html(data);
                            //     }
                            // });
                        });
                    });
                });
            });
        </script>


        <div class="footer">
            <a href="#news1">About</a>
            <a href="#news2">Contact Us</a>
            <a href="#news3">FAQ</a>
            <a href="#news4">Privacy Policy</a>
        </div>
        <div id="myNav" class="overlay">
            <div class="overlay-content">
                <a href="/">Home</a>
                <a href="/news">News</a>
                <a href="/team">Our Team</a>
                <a href="/funding">Funders</a>
                <a href="/tutorial">Tutorial</a>
                <a href="/annotate" class="getInvolved">Get Involved</a>
            </div>
        </div>
        {% block content %}{% endblock %}
    </body>
</html>